<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>İstanbul Canlı Trafik</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        /* Modern ve Temiz Tasarım */
        body { margin: 0; padding: 0; font-family: 'Roboto', sans-serif; }
        #map { width: 100vw; height: 100vh; position: absolute; top: 0; left: 0; z-index: 1; }

        /* Sol Üst Bilgi Kartı */
        .info-card {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            z-index: 1000;
            width: 240px;
        }
        .info-card h2 { margin: 0 0 5px 0; font-size: 18px; color: #333; }
        .info-card p { margin: 0 0 15px 0; font-size: 13px; color: #666; }
        
        .status-badge {
            display: inline-block;
            background: #e8f5e9;
            color: #2e7d32;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }

        /* Sağ Alt Trafik Skalası */
        .legend {
            position: absolute;
            bottom: 30px;
            right: 20px;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            font-size: 12px;
        }
        .gradient-bar {
            width: 200px;
            height: 8px;
            background: linear-gradient(to right, #6EBE4A, #FFC300, #E60000); /* Yeşil-Sarı-Kırmızı */
            border-radius: 4px;
            margin-bottom: 5px;
        }
        .labels { display: flex; justify-content: space-between; color: #555; font-weight: 500; }

    </style>
</head>
<body>

    <div class="info-card">
        <h2>İstanbul Trafik</h2>
        <p>Canlı Yoğunluk Haritası</p>
        <div class="status-badge">● Veriler Güncel</div>
    </div>

    <div class="legend">
        <div class="gradient-bar"></div>
        <div class="labels">
            <span>Akıcı</span>
            <span>Yoğun</span>
            <span>Sıkışık</span>
        </div>
    </div>

    <div id="map"></div>

    <script>
        // --- AYARLAR ---
        
        // 1. HARİTA (Sade ve Aydınlık - IBB Tarzı)
        var map = L.map('map').setView([41.0082, 28.9784], 10);
        
        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
            attribution: '© OpenStreetMap, © CartoDB',
            maxZoom: 20
        }).addTo(map);

        // 2. API KEY (Buraya Kendi Keyini Yapıştır)
        // DİKKAT: İçinde tire (-) olmamalı!
        const API_KEY = 'uWD6Bs17qsOMpQY9yMZJejwu6YnErjWk'; 

        // --- TRAFİK KODU ---
        
        // Hata Kontrolü: Key yanlış formatta mı?
        if (API_KEY.includes('-') || API_KEY.length < 10) {
            alert("HATA: API Key formatı yanlış görünüyor! Lütfen TomTom sitesinden, içinde tire (-) olmayan kodu kopyala.");
        } 
        else if (API_KEY === 'BURAYA_GERCEK_API_KEYINI_YAPISTIR') {
            alert("UYARI: Koda henüz API Key yapıştırmadın!");
        } 
        else {
            // Key düzgünse trafiği yükle
            const trafficUrl = `https://api.tomtom.com/traffic/map/4/tile/flow/absolute/{z}/{x}/{y}.png?key=${API_KEY}&thickness=10`;
            
            L.tileLayer(trafficUrl, { opacity: 1, maxZoom: 22 }).addTo(map);
            console.log("Trafik katmanı başarıyla yüklendi.");
        }

        // Marker
        L.marker([41.0082, 28.9784]).addTo(map).bindPopup('İstanbul Merkez');
    </script>
</body>
</html>
